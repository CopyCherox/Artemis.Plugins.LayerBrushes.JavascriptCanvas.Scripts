<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
  line-height: 1.6; 
  color: #333; 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh; 
}
.container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
.hero { 
  text-align: center; 
  padding: 4rem 0; 
  background: rgba(255,255,255,0.9); 
  margin: 2rem auto 3rem; 
  max-width: 900px; 
  border-radius: 20px; 
  box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
}
.hero h1 { font-size: 3rem; color: #333; margin-bottom: 1rem; }
.hero p { font-size: 1.2rem; color: #666; }
.scripts-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
  gap: 2rem; 
  margin: 0 auto 4rem; 
  max-width: 1200px; 
  padding: 0 1rem;
}
.script-card { 
  background: rgba(255,255,255,0.95); 
  border-radius: 20px; 
  overflow: hidden; 
  box-shadow: 0 10px 40px rgba(0,0,0,0.15); 
  transition: all 0.3s ease; 
  backdrop-filter: blur(10px); 
}
.script-card:hover { 
  transform: translateY(-10px) scale(1.02); 
  box-shadow: 0 20px 60px rgba(0,0,0,0.25); 
}
.script-link { display: block; text-decoration: none; color: inherit; height: 100%; }
.script-image { 
  position: relative; 
  height: 200px; 
  background: #000; 
  overflow: hidden; 
}
.script-image img { 
  width: 100%; 
  height: 100%; 
  object-fit: cover; 
  transition: opacity 0.3s ease;
  background: #000;
}
.script-image canvas { 
  position: absolute; 
  top: 0; left: 0; 
  width: 100%; 
  height: 100%; 
  opacity: 0; 
  transition: opacity 0.3s ease;
  object-fit: cover;
}
.script-card:hover .script-image img { opacity: 0; }
.script-card:hover .script-image canvas { opacity: 1; }
.download-icon { 
  position: absolute; 
  top: 15px; right: 15px; 
  background: rgba(0,0,0,0.8); 
  color: white; 
  width: 40px; height: 40px; 
  border-radius: 50%; 
  display: flex; align-items: center; justify-content: center; 
  font-size: 1.2rem; 
  opacity: 0; transition: opacity 0.3s ease; 
  z-index: 10;
}
.script-card:hover .download-icon { opacity: 1; }
.script-card h3 { padding: 1.5rem 1.5rem 0.5rem; font-size: 1.3rem; color: #333; }
.script-card p { padding: 0 1.5rem 1.5rem; color: #666; font-size: 0.95rem; }
.install-guide { 
  background: rgba(255,255,255,0.9); 
  padding: 3rem; 
  border-radius: 20px; 
  margin: 4rem auto; 
  max-width: 800px; 
  text-align: center; 
}
.install-guide h2 { font-size: 2rem; color: #333; margin-bottom: 2rem; }
.install-guide ol { display: grid; gap: 1rem; max-width: 600px; margin: 0 auto; text-align: left; font-size: 1.1rem; }
.install-guide li { background: white; padding: 1rem 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
.site-footer { background: rgba(0,0,0,0.8); color: white; text-align: center; padding: 2rem 0; margin-top: 4rem; }
.site-footer a { color: #4fc3f7; text-decoration: none; }
.loading { opacity: 0.5; }
@media (max-width: 768px) { 
  .hero h1 { font-size: 2.2rem; } 
  .scripts-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; }
  .install-guide { padding: 2rem 1rem; margin: 2rem 1rem; }
}
</style>

<main>
  <div class="hero">
    <h1>ðŸŽ¨ JavaScript Canvas Scripts</h1>
    <p>Download LED effects for the <a href="https://github.com/CopyCherox/Artemis.Plugins.LayerBrushes.JavascriptCanvas">Artemis JavaScript Canvas plugin</a></p>
  </div>

  <div class="scripts-grid">
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/fire-effect.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/fire-effect.json" class="script-link" download="fire-effect.json">
        <div class="script-image">
          <img alt="Fire" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Fire</h3>
        <p>Realistic per-pixel fire simulation</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/checkerboard-pulse.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/checkerboard-pulse.json" class="script-link" download="checkerboard-pulse.json">
        <div class="script-image">
          <img alt="Checkerboard pulse" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Checkerboard pulse</h3>
        <p>Moving checherboard effect</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/retro-scanlines.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/retro-scanlines.json" class="script-link" download="retro-scanlines.json">
        <div class="script-image">
          <img alt="Retro Scanlines" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Retro Scanlines</h3>
        <p>Moving cyan scan line effect</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/plasma-wave-field.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/plasma-wave-field.json" class="script-link" download="plasma-wave-field.json">
        <div class="script-image">
          <img alt="Plasma Wave Field" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Plasma Wave Field</h3>
        <p>Moving cyan scan line effect</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/pulsing-circle-grid.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/pulsing-circle-grid.json" class="script-link" download="pulsing-circle-grid.json">
        <div class="script-image">
          <img alt="Pulsing Circle Grid" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Pulsing Circle Grid</h3>
        <p>Grid of pulsing animated circles</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/hexagonal-pulse-grid.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/hexagonal-pulse-grid.json" class="script-link" download="hexagonal-pulse-grid.json">
        <div class="script-image">
          <img alt="Hexagonal Pulse Grid" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Hexagonal Pulse Grid</h3>
        <p>Animated hexagonal pulse pattern</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-color-vortex.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-color-vortex.json" class="script-link" download="rotating-color-vortex.json">
        <div class="script-image">
          <img alt="Rotating Color Vortex" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Rotating Color Vortex</h3>
        <p>Spinning colorful vortex effect</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-kaleidoscope-circles.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-kaleidoscope-circles.json" class="script-link" download="rotating-kaleidoscope-circles.json">
        <div class="script-image">
          <img alt="Rotating Kaleidoscope Circles" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Rotating Kaleidoscope Circles</h3>
        <p>Symmetrical rotating circle patterns</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-triangle-mosaic.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/rotating-triangle-mosaic.json" class="script-link" download="rotating-triangle-mosaic.json">
        <div class="script-image">
          <img alt="Rotating Triangle Mosaic" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Rotating Triangle Mosaic</h3>
        <p>Spinning triangle tile pattern</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/smooth-gradient-flow.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/smooth-gradient-flow.json" class="script-link" download="smooth-gradient-flow.json">
        <div class="script-image">
          <img alt="Smooth Gradient Flow" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Smooth Gradient Flow</h3>
        <p>Flowing animated rainbow gradient</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/spiral-vortex-particles.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/spiral-vortex-particles.json" class="script-link" download="spiral-vortex-particles.json">
        <div class="script-image">
          <img alt="Spiral Vortex Particles" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Spiral Vortex Particles</h3>
        <p>Swirling particle spiral vortex</p>
      </a>
    </div>
    
    <div class="script-card loading" data-script="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/waving-diamond-grid.json">
      <a href="/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts/scripts/waving-diamond-grid.json" class="script-link" download="waving-diamond-grid.json">
        <div class="script-image">
          <img alt="Waving Diamond Grid" />
          <canvas></canvas>
          <div class="download-icon">ðŸ“¥</div>
        </div>
        <h3>Waving Diamond Grid</h3>
        <p>Undulating diamond tile wave</p>
      </a>
    </div>
    
  </div>

  <div class="install-guide">
    <h2>How to Install</h2>
    <ol>
      <li>Download a script by clicking any card above</li>
      <li>Open Artemis â†’ Add JavaScript Canvas layer brush</li>
      <li>Click "Import..." â†’ Select the .json file</li>
      <li>Select the script and click "Apply Changes to Layer Brush"</li>
    </ol>
  </div>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; 2025 <a href="https://github.com/CopyCherox">CopyCherox</a> | 
         <a href="https://github.com/CopyCherox/Artemis.Plugins.LayerBrushes.JavascriptCanvas.Scripts">Source</a></p>
    </div>
  </footer>
</main>

<script>
class CanvasContext {
  constructor(canvas) {
    this.canvas = canvas;
    this.ctx = canvas.getContext('2d');
    this.width = canvas.width;
    this.height = canvas.height;
    this._fillColor = { r: 255, g: 255, b: 255 };
    this._gradient = null;
  }

  clear(r = 0, g = 0, b = 0) {
    this.ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;
    this.ctx.fillRect(0, 0, this.width, this.height);
  }

  fillStyle(r, g, b, a = 255) {
    this._fillColor = { r, g, b, a };
    this._gradient = null;
    this.ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${a / 255})`;
  }

  fillStyleGradient(gradient) {
    this._gradient = gradient;
    this.ctx.fillStyle = gradient.canvasGradient;
  }

  fillRect(x, y, w, h) {
    this.ctx.fillRect(x, y, w, h);
  }

  fillCircle(x, y, radius) {
    this.ctx.beginPath();
    this.ctx.arc(x, y, radius, 0, Math.PI * 2);
    this.ctx.fill();
  }

  beginPath() {
    this.ctx.beginPath();
  }

  arc(x, y, radius, startAngle, endAngle) {
    this.ctx.arc(x, y, radius, startAngle, endAngle);
  }

  fill() {
    this.ctx.fill();
  }

  moveTo(x, y) {
    this.ctx.moveTo(x, y);
  }

  lineTo(x, y) {
    this.ctx.lineTo(x, y);
  }

  closePath() {
    this.ctx.closePath();
  }

  save() {
    this.ctx.save();
  }

  restore() {
    this.ctx.restore();
  }

  translate(x, y) {
    this.ctx.translate(x, y);
  }

  rotate(angle) {
    this.ctx.rotate(angle);
  }

  scale(x, y) {
    this.ctx.scale(x, y);
  }

  createLinearGradient(x0, y0, x1, y1) {
    return new CanvasGradient(this.ctx.createLinearGradient(x0, y0, x1, y1));
  }

  createRadialGradient(x0, y0, r0, x1, y1, r1) {
    return new CanvasGradient(this.ctx.createRadialGradient(x0, y0, r0, x1, y1, r1));
  }

  hslToRgb(h, s, l) {
    let r, g, b;
    if (s === 0) {
      r = g = b = l;
    } else {
      const hue2rgb = (p, q, t) => {
        if (t < 0) t += 1;
        if (t > 1) t -= 1;
        if (t < 1/6) return p + (q - p) * 6 * t;
        if (t < 1/2) return q;
        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
        return p;
      };
      const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      const p = 2 * l - q;
      r = hue2rgb(p, q, h + 1/3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1/3);
    }
    return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
  }

  get globalCompositeOperation() {
    return this.ctx.globalCompositeOperation;
  }

  set globalCompositeOperation(value) {
    this.ctx.globalCompositeOperation = value;
  }
}

class CanvasGradient {
  constructor(canvasGradient) {
    this.canvasGradient = canvasGradient;
  }

  addColorStop(offset, r, g, b, a = 255) {
    this.canvasGradient.addColorStop(offset, `rgba(${r}, ${g}, ${b}, ${a / 255})`);
  }
}

class ScriptPlayer {
  constructor(card) {
    this.card = card;
    this.canvas = card.querySelector('canvas');
    this.img = card.querySelector('img');
    this.scriptUrl = card.dataset.script;
    this.ctx = null;
    this.scriptCode = null;
    this.animationId = null;
    this.startTime = null;
    this.isPlaying = false;
    this.thumbnailGenerated = false;
    
    // Set canvas size to match display size
    const rect = this.canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    this.canvas.width = rect.width * dpr;
    this.canvas.height = rect.height * dpr;
    this.canvas.getContext('2d').scale(dpr, dpr);
  }

  async load() {
    if (this.scriptCode) return;
    try {
      const response = await fetch(this.scriptUrl);
      const data = await response.json();
      this.scriptCode = data.JavaScriptCode;
    } catch (err) {
      console.error('Failed to load script:', err);
    }
  }

  async generateThumbnail() {
    if (this.thumbnailGenerated) return;
    
    await this.load();
    if (!this.scriptCode) return;

    this.ctx = new CanvasContext(this.canvas);
    const width = this.canvas.width;
    const height = this.canvas.height;
    const ctx = this.ctx;
    
    // Render at time = 0.5 seconds for a good representative frame
    const time = 0.5;
    
    try {
      eval(this.scriptCode);
    } catch (err) {
      console.error('Thumbnail generation error:', err);
      return;
    }

    // Convert canvas to image
    this.img.src = this.canvas.getContext('2d').canvas.toDataURL();
    this.thumbnailGenerated = true;
    this.card.classList.remove('loading');
  }

  start() {
    if (this.isPlaying || !this.scriptCode) return;
    this.isPlaying = true;
    this.startTime = performance.now();
    this.ctx = new CanvasContext(this.canvas);
    this.animate();
  }

  animate() {
    if (!this.isPlaying) return;

    const time = (performance.now() - this.startTime) / 1000;
    const width = this.canvas.width;
    const height = this.canvas.height;
    const ctx = this.ctx;

    try {
      eval(this.scriptCode);
    } catch (err) {
      console.error('Script execution error:', err);
      this.stop();
      return;
    }

    this.animationId = requestAnimationFrame(() => this.animate());
  }

  stop() {
    this.isPlaying = false;
    if (this.animationId) {
      cancelAnimationFrame(this.animationId);
      this.animationId = null;
    }
  }
}

// Initialize all script players
const players = new Map();

document.querySelectorAll('.script-card').forEach((card, index) => {
  const player = new ScriptPlayer(card);
  players.set(card, player);

  // Generate thumbnails with staggered delay for smooth loading
  setTimeout(() => {
    player.generateThumbnail();
  }, index * 100);

  card.addEventListener('mouseenter', async () => {
    await player.load();
    player.start();
  });

  card.addEventListener('mouseleave', () => {
    player.stop();
  });
});
</script>

